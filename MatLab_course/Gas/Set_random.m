function out = set_random(v_mean)
% Генерация случайных координат для частиц в прямоугольной области. 
% Позиции всех частиц и их скорости инициализируются по указанным правилам.
% Скорости всех частиц задаются равными v_mean по осям x и y.

global rad lx ly n;

% Инициализация скоростей частиц
vx = v_mean * ones(1, n);
vy = zeros(1, n);
x = zeros(1, n);
y = zeros(1, n);

% Генерация случайных координат частиц
for i = 1:n
    l = 0;
    k = 0;
    
    % Пытаемся генерировать новые позиции частиц, проверяя столкновения
    while k < 100
        xt = rad(i) + rand * (lx - 2 * rad(i));
        yt = rad(i) + rand * (ly - 2 * rad(i));
        l = 0;
        
        % Проверка на столкновение с уже размещенными частицами
        for j = 1:i-1
            d = sqrt((xt - x(j))^2 + (yt - y(j))^2);
            if d < rad(i) + rad(j)
                l = 1;  % Если столкновение найдено, пробуем снова
            end
        end
        
        % Если столкновений нет, сохраняем координаты
        if l == 0
            break;
        end
        
        k = k + 1;
        
        % Если не удалось найти подходящее место после 100 попыток
        if k == 99
            error('Задайте большее количество частиц или размер.');
        end
    end
    
    % Сохранение координат частицы
    x(i) = xt;
    y(i) = yt;
end

% Возвращаем результат
out = [x; y; vx; vy];
